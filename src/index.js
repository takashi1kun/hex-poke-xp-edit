document.getElementById("app").innerHTML = `
 <div
          style="background-color: #4daf7c; border-radius: 25px 25px 0px 0px; margin: -26px 0px 0px -25px; display: inline-block; position:
		absolute; width: 33.3333333333333%; text-align: center; min-width: 488.18;"
        >
          <h1>Pokemon let's go xp mod percentage changer</h1>
        </div>
<div >
   <form style="margin: 135px 0px 0px 0px;" class="pure-form pure-form-stacked" id="frm1" >
     <div class="text-input">   <div style="color: #999;"><select id="percfile1" name="perc1">
    <option value="0">Select Percentage:</option>
<option value="1">0%</option>
<option value="2">1%</option>
<option value="3">2%</option>
<option value="4">3%</option>
<option value="5">4%</option>
<option value="6">5%</option>
<option value="7">6%</option>
<option value="8">7%</option>
<option value="9">8%</option>
<option value="10">9%</option>
<option value="11">10%</option>
<option value="12">11%</option>
<option value="13">12%</option>
<option value="14">13%</option>
<option value="15">14%</option>
<option value="16">15%</option>
<option value="17">16%</option>
<option value="18">17%</option>
<option value="19">18%</option>
<option value="20">19%</option>
<option value="21">20%</option>
<option value="22">21%</option>
<option value="23">22%</option>
<option value="24">23%</option>
<option value="25">24%</option>
<option value="26">25%</option>
<option value="27">26%</option>
<option value="28">27%</option>
<option value="29">28%</option>
<option value="30">29%</option>
<option value="31">30%</option>
<option value="32">31%</option>
<option value="33">32%</option>
<option value="34">33%</option>
<option value="35">34%</option>
<option value="36">35%</option>
<option value="37">36%</option>
<option value="38">37%</option>
<option value="39">38%</option>
<option value="40">39%</option>
<option value="41">40%</option>
<option value="42">41%</option>
<option value="43">42%</option>
<option value="44">43%</option>
<option value="45">44%</option>
<option value="46">45%</option>
<option value="47">46%</option>
<option value="48">47%</option>
<option value="49">48%</option>
<option value="50">49%</option>
<option value="51">50%</option>
<option value="52">51%</option>
<option value="53">52%</option>
<option value="54">53%</option>
<option value="55">54%</option>
<option value="56">55%</option>
<option value="57">56%</option>
<option value="58">57%</option>
<option value="59">58%</option>
<option value="60">59%</option>
<option value="61">60%</option>
<option value="62">61%</option>
<option value="63">62%</option>
<option value="64">63%</option>
<option value="65">64%</option>
<option value="66">65%</option>
<option value="67">66%</option>
<option value="68">67%</option>
<option value="69">68%</option>
<option value="70">69%</option>
<option value="71">70%</option>
<option value="72">71%</option>
<option value="73">72%</option>
<option value="74">73%</option>
<option value="75">74%</option>
<option value="76">75%</option>
<option value="77">76%</option>
<option value="78">77%</option>
<option value="79">78%</option>
<option value="80">79%</option>
<option value="81">80%</option>
<option value="82">81%</option>
<option value="83">82%</option>
<option value="84">83%</option>
<option value="85">84%</option>
<option value="86">85%</option>
<option value="87">86%</option>
<option value="88">87%</option>
<option value="89">88%</option>
<option value="90">89%</option>
<option value="91">90%</option>
<option value="92">91%</option>
<option value="93">92%</option>
<option value="94">93%</option>
<option value="95">94%</option>
<option value="96">95%</option>
<option value="97">96%</option>
<option value="98">97%</option>
<option value="99">98%</option>
<option value="100">99%</option>
<option value="101">100%</option>
<option value="102">101%</option>
<option value="103">102%</option>
<option value="104">103%</option>
<option value="105">104%</option>
<option value="106">105%</option>
<option value="107">106%</option>
<option value="108">107%</option>
<option value="109">108%</option>
<option value="110">109%</option>
<option value="111">110%</option>
<option value="112">111%</option>
<option value="113">112%</option>
<option value="114">113%</option>
<option value="115">114%</option>
<option value="116">115%</option>
<option value="117">116%</option>
<option value="118">117%</option>
<option value="119">118%</option>
<option value="120">119%</option>
<option value="121">120%</option>
<option value="122">121%</option>
<option value="123">122%</option>
<option value="124">123%</option>
<option value="125">124%</option>
<option value="126">125%</option>
<option value="127">126%</option>
<option value="128">127%</option>
<option value="129">128%</option>
<option value="130">129%</option>
<option value="131">130%</option>
<option value="132">131%</option>
<option value="133">132%</option>
<option value="134">133%</option>
<option value="135">134%</option>
<option value="136">135%</option>
<option value="137">136%</option>
<option value="138">137%</option>
<option value="139">138%</option>
<option value="140">139%</option>
<option value="141">140%</option>
<option value="142">141%</option>
<option value="143">142%</option>
<option value="144">143%</option>
<option value="145">144%</option>
<option value="146">145%</option>
<option value="147">146%</option>
<option value="148">147%</option>
<option value="149">148%</option>
<option value="150">149%</option>
<option value="151">150%</option>
<option value="152">151%</option>
<option value="153">152%</option>
<option value="154">153%</option>
<option value="155">154%</option>
<option value="156">155%</option>
<option value="157">156%</option>
<option value="158">157%</option>
<option value="159">158%</option>
<option value="160">159%</option>
<option value="161">160%</option>
<option value="162">161%</option>
<option value="163">162%</option>
<option value="164">163%</option>
<option value="165">164%</option>
<option value="166">165%</option>
<option value="167">166%</option>
<option value="168">167%</option>
<option value="169">168%</option>
<option value="170">169%</option>
<option value="171">170%</option>
<option value="172">171%</option>
<option value="173">172%</option>
<option value="174">173%</option>
<option value="175">174%</option>
<option value="176">175%</option>
<option value="177">176%</option>
<option value="178">177%</option>
<option value="179">178%</option>
<option value="180">179%</option>
<option value="181">180%</option>
<option value="182">181%</option>
<option value="183">182%</option>
<option value="184">183%</option>
<option value="185">184%</option>
<option value="186">185%</option>
<option value="187">186%</option>
<option value="188">187%</option>
<option value="189">188%</option>
<option value="190">189%</option>
<option value="191">190%</option>
<option value="192">191%</option>
<option value="193">192%</option>
<option value="194">193%</option>
<option value="195">194%</option>
<option value="196">195%</option>
<option value="197">196%</option>
<option value="198">197%</option>
<option value="199">198%</option>
<option value="200">199%</option>
<option value="201">200%</option>
<option value="202">201%</option>
<option value="203">202%</option>
<option value="204">203%</option>
<option value="205">204%</option>
<option value="206">205%</option>
<option value="207">206%</option>
<option value="208">207%</option>
<option value="209">208%</option>
<option value="210">209%</option>
<option value="211">210%</option>
<option value="212">211%</option>
<option value="213">212%</option>
<option value="214">213%</option>
<option value="215">214%</option>
<option value="216">215%</option>
<option value="217">216%</option>
<option value="218">217%</option>
<option value="219">218%</option>
<option value="220">219%</option>
<option value="221">220%</option>
<option value="222">221%</option>
<option value="223">222%</option>
<option value="224">223%</option>
<option value="225">224%</option>
<option value="226">225%</option>
<option value="227">226%</option>
<option value="228">227%</option>
<option value="229">228%</option>
<option value="230">229%</option>
<option value="231">230%</option>
<option value="232">231%</option>
<option value="233">232%</option>
<option value="234">233%</option>
<option value="235">234%</option>
<option value="236">235%</option>
<option value="237">236%</option>
<option value="238">237%</option>
<option value="239">238%</option>
<option value="240">239%</option>
<option value="241">240%</option>
<option value="242">241%</option>
<option value="243">242%</option>
<option value="244">243%</option>
<option value="245">244%</option>
<option value="246">245%</option>
<option value="247">246%</option>
<option value="248">247%</option>
<option value="249">248%</option>
<option value="250">249%</option>
<option value="251">250%</option>
<option value="252">251%</option>
<option value="253">252%</option>
<option value="254">253%</option>
<option value="255">254%</option>
<option value="256">255%</option>
  </select><label for="percfile1">File 1 Percentage:</label></div></div>
         <div class="text-input" style="margin-top: 30px;"><div style="color: #999;"><select id="percfile2" name="perc2">
    <option value="0">Select Percentage:</option>
<option value="1">0%</option>
<option value="2">1%</option>
<option value="3">2%</option>
<option value="4">3%</option>
<option value="5">4%</option>
<option value="6">5%</option>
<option value="7">6%</option>
<option value="8">7%</option>
<option value="9">8%</option>
<option value="10">9%</option>
<option value="11">10%</option>
<option value="12">11%</option>
<option value="13">12%</option>
<option value="14">13%</option>
<option value="15">14%</option>
<option value="16">15%</option>
<option value="17">16%</option>
<option value="18">17%</option>
<option value="19">18%</option>
<option value="20">19%</option>
<option value="21">20%</option>
<option value="22">21%</option>
<option value="23">22%</option>
<option value="24">23%</option>
<option value="25">24%</option>
<option value="26">25%</option>
<option value="27">26%</option>
<option value="28">27%</option>
<option value="29">28%</option>
<option value="30">29%</option>
<option value="31">30%</option>
<option value="32">31%</option>
<option value="33">32%</option>
<option value="34">33%</option>
<option value="35">34%</option>
<option value="36">35%</option>
<option value="37">36%</option>
<option value="38">37%</option>
<option value="39">38%</option>
<option value="40">39%</option>
<option value="41">40%</option>
<option value="42">41%</option>
<option value="43">42%</option>
<option value="44">43%</option>
<option value="45">44%</option>
<option value="46">45%</option>
<option value="47">46%</option>
<option value="48">47%</option>
<option value="49">48%</option>
<option value="50">49%</option>
<option value="51">50%</option>
<option value="52">51%</option>
<option value="53">52%</option>
<option value="54">53%</option>
<option value="55">54%</option>
<option value="56">55%</option>
<option value="57">56%</option>
<option value="58">57%</option>
<option value="59">58%</option>
<option value="60">59%</option>
<option value="61">60%</option>
<option value="62">61%</option>
<option value="63">62%</option>
<option value="64">63%</option>
<option value="65">64%</option>
<option value="66">65%</option>
<option value="67">66%</option>
<option value="68">67%</option>
<option value="69">68%</option>
<option value="70">69%</option>
<option value="71">70%</option>
<option value="72">71%</option>
<option value="73">72%</option>
<option value="74">73%</option>
<option value="75">74%</option>
<option value="76">75%</option>
<option value="77">76%</option>
<option value="78">77%</option>
<option value="79">78%</option>
<option value="80">79%</option>
<option value="81">80%</option>
<option value="82">81%</option>
<option value="83">82%</option>
<option value="84">83%</option>
<option value="85">84%</option>
<option value="86">85%</option>
<option value="87">86%</option>
<option value="88">87%</option>
<option value="89">88%</option>
<option value="90">89%</option>
<option value="91">90%</option>
<option value="92">91%</option>
<option value="93">92%</option>
<option value="94">93%</option>
<option value="95">94%</option>
<option value="96">95%</option>
<option value="97">96%</option>
<option value="98">97%</option>
<option value="99">98%</option>
<option value="100">99%</option>
<option value="101">100%</option>
<option value="102">101%</option>
<option value="103">102%</option>
<option value="104">103%</option>
<option value="105">104%</option>
<option value="106">105%</option>
<option value="107">106%</option>
<option value="108">107%</option>
<option value="109">108%</option>
<option value="110">109%</option>
<option value="111">110%</option>
<option value="112">111%</option>
<option value="113">112%</option>
<option value="114">113%</option>
<option value="115">114%</option>
<option value="116">115%</option>
<option value="117">116%</option>
<option value="118">117%</option>
<option value="119">118%</option>
<option value="120">119%</option>
<option value="121">120%</option>
<option value="122">121%</option>
<option value="123">122%</option>
<option value="124">123%</option>
<option value="125">124%</option>
<option value="126">125%</option>
<option value="127">126%</option>
<option value="128">127%</option>
<option value="129">128%</option>
<option value="130">129%</option>
<option value="131">130%</option>
<option value="132">131%</option>
<option value="133">132%</option>
<option value="134">133%</option>
<option value="135">134%</option>
<option value="136">135%</option>
<option value="137">136%</option>
<option value="138">137%</option>
<option value="139">138%</option>
<option value="140">139%</option>
<option value="141">140%</option>
<option value="142">141%</option>
<option value="143">142%</option>
<option value="144">143%</option>
<option value="145">144%</option>
<option value="146">145%</option>
<option value="147">146%</option>
<option value="148">147%</option>
<option value="149">148%</option>
<option value="150">149%</option>
<option value="151">150%</option>
<option value="152">151%</option>
<option value="153">152%</option>
<option value="154">153%</option>
<option value="155">154%</option>
<option value="156">155%</option>
<option value="157">156%</option>
<option value="158">157%</option>
<option value="159">158%</option>
<option value="160">159%</option>
<option value="161">160%</option>
<option value="162">161%</option>
<option value="163">162%</option>
<option value="164">163%</option>
<option value="165">164%</option>
<option value="166">165%</option>
<option value="167">166%</option>
<option value="168">167%</option>
<option value="169">168%</option>
<option value="170">169%</option>
<option value="171">170%</option>
<option value="172">171%</option>
<option value="173">172%</option>
<option value="174">173%</option>
<option value="175">174%</option>
<option value="176">175%</option>
<option value="177">176%</option>
<option value="178">177%</option>
<option value="179">178%</option>
<option value="180">179%</option>
<option value="181">180%</option>
<option value="182">181%</option>
<option value="183">182%</option>
<option value="184">183%</option>
<option value="185">184%</option>
<option value="186">185%</option>
<option value="187">186%</option>
<option value="188">187%</option>
<option value="189">188%</option>
<option value="190">189%</option>
<option value="191">190%</option>
<option value="192">191%</option>
<option value="193">192%</option>
<option value="194">193%</option>
<option value="195">194%</option>
<option value="196">195%</option>
<option value="197">196%</option>
<option value="198">197%</option>
<option value="199">198%</option>
<option value="200">199%</option>
<option value="201">200%</option>
<option value="202">201%</option>
<option value="203">202%</option>
<option value="204">203%</option>
<option value="205">204%</option>
<option value="206">205%</option>
<option value="207">206%</option>
<option value="208">207%</option>
<option value="209">208%</option>
<option value="210">209%</option>
<option value="211">210%</option>
<option value="212">211%</option>
<option value="213">212%</option>
<option value="214">213%</option>
<option value="215">214%</option>
<option value="216">215%</option>
<option value="217">216%</option>
<option value="218">217%</option>
<option value="219">218%</option>
<option value="220">219%</option>
<option value="221">220%</option>
<option value="222">221%</option>
<option value="223">222%</option>
<option value="224">223%</option>
<option value="225">224%</option>
<option value="226">225%</option>
<option value="227">226%</option>
<option value="228">227%</option>
<option value="229">228%</option>
<option value="230">229%</option>
<option value="231">230%</option>
<option value="232">231%</option>
<option value="233">232%</option>
<option value="234">233%</option>
<option value="235">234%</option>
<option value="236">235%</option>
<option value="237">236%</option>
<option value="238">237%</option>
<option value="239">238%</option>
<option value="240">239%</option>
<option value="241">240%</option>
<option value="242">241%</option>
<option value="243">242%</option>
<option value="244">243%</option>
<option value="245">244%</option>
<option value="246">245%</option>
<option value="247">246%</option>
<option value="248">247%</option>
<option value="249">248%</option>
<option value="250">249%</option>
<option value="251">250%</option>
<option value="252">251%</option>
<option value="253">252%</option>
<option value="254">253%</option>
<option value="255">254%</option>
<option value="256">255%</option>
  </select><label for="percfile2"> New Percentage  : </label></div></div>

        <br />
         <div class="text-input" style="margin-top: 0;"><label style="position:relative; border-radius: 3px; top: 10;">  File 1 :</label></div>
      <span></span>
<textarea style="color: black;" class="pure-input-1" rows="8" cols="50" name="file1" id="file1"></textarea><br /> <div class="file-upload-wrapper" data-text="Upload File 1!">
      <input class="file-upload-field" type="file" name="fileinput" onchange="openFile1(event)" /><span></span></div><br />
      <div class="text-input" style="margin-top: 0;"><label style="position:relative; border-radius: 3px; top: 10;">  File 2 :</label></div>
      <textarea style="color: black;" class="pure-input-1" rows="8" cols="50" name="file2" id="file2"></textarea
      ><br /><div class="file-upload-wrapper" data-text="Upload File 2!"><input class="file-upload-field" type="file" name="fileinput" onchange="openFile2(event)"
      /><br /></div><div style="margin-top: 30px;">
  
      
       <div class="text-input" style="margin-top: 30;"><label style="position:relative; border-radius: 3px; top: 10;"> Result:</label></div>
     <textarea style="color: black;" readonly id="demo" rows="8" cols="50" class="pure-input-1"></textarea>
      </form>
      

      <p id="demo2"></p>

      <div class="pure-button-group pure-form pure-form-stacked"> <button type="button" class="pure-button pure-input-1-2 pure-button-primary" onclick="generateFile(); return false"><i class="fas fa-cogs"></i>  Generate</button><button type="button" style="background: rgb(202, 60, 60);" class="pure-button pure-input-1-2 pure-button-primary" id="downloadButton" onclick="saveFileToComputer(); return false" disabled=""><i class="fas fa-download"></i> Download</button> </div>
       
<div>
<div class="pure-g">
    <div class="pure-u-1-3"><p></p></div>
    <div class="pure-u-1-3"><p>
<a style="color:white;font-weight: 700; text-decoration: none;" href="https://github.com/takashi1kun/hex-poke-xp-edit">Github Page</a><br />
<a style="color:white;font-weight: 700; text-decoration: none;" href="https://gbatemp.net/threads/pokemon-lets-go-altered-experience-gain-mod-customizer.524909/">GBAtemp Post</a></p></div>
    <div class="pure-u-1-3"><p></p></div>
</div>
</div>
</div>
`;
document.getElementById("downloadButton").disabled = true;
//Variables

var file1hex;
var file2hex;
var fileData;
var fileOutputHex;
var readFileAsArrayMode;

//functions

//hex comparing functions

var changePercentage = function(perc1, perc2, a, b) {
  var hex1 = file1hex != null ? file1hex : a.split(" ");
  var hex2 = file2hex != null ? file2hex : b.split(" ");
  var decTemp;
  var hexResult = [];
  var dec1 = reConvert(hex1);
  var dec2 = reConvert(hex2);
  for (i = 0; i != dec1.length; i++) {
    if (dec1[i] != dec2[i]) {
      decTemp = Math.floor((dec1[i] / perc1) * perc2);
      decTemp = decTemp > 255 ? 255 : decTemp;
      decTemp = decTemp < 0 ? 0 : decTemp;
      hexResult[i] = decimalToHexDouble(decTemp);
    } else {
      hexResult[i] = hex1[i];
    }
  }
  fileOutputHex = hexResult;
  document.getElementById("demo").innerHTML = writeHex(hexResult, true);
  document.getElementById("downloadButton").disabled = false;
};

var writeHex = function(array, mode) {
  if (mode) {
    return array.join(" ");
  } else {
    return array.join("");
  }
};

var decimalToHexDouble = function(d, padding) {
  var hex = Number(d).toString(16);
  padding =
    typeof padding === "undefined" || padding === null
      ? (padding = 2)
      : padding;

  while (hex.length < padding) {
    hex = "0" + hex;
  }

  return hex;
};

//Document Manipulation Functions

var generateFile = function() {
  var a = document.getElementById("file1").value;
  var b = document.getElementById("file2").value;
  var x = document.getElementById("frm1");
  var perc1 = x.perc1.value != 0 ? x.perc1.value - 1 : 300;
  var perc2 = x.perc2.value != 0 ? x.perc2.value - 1 : 300;
  if (perc1 != 300 && perc2 != 300 && a != "" && b != "") {
    changePercentage(perc1, perc2, a, b);
  }
};

var openFile1 = function(event) {
  var input = event.target;
  readFileAsArray(input.files[0], true);
};
var openFile2 = function(event) {
  var input = event.target;
  readFileAsArray(input.files[0], false);
};

//Saving Functions

var saveFileToComputer = function() {
  var byteArray = reConvert(fileOutputHex);
  var blob = new Blob([byteArray], {
    type: "application/octet-stream"
  });
  saveAs(blob, "personal_total.bin");
};

var reConvert = function(hexArray) {
  var decimalArray = [];
  for (i = 0; i < hexArray.length; i++) {
    decimalArray[i] = parseInt(hexArray[i], 16);
  }
  return new Uint8Array(decimalArray);
};

//Loading Functions

var Convert = function(uint8View) {
  var hexArray = [];
  for (i = 0; i < uint8View.length; i++) {
    hexArray[i] = decimalToHexDouble(uint8View[i]);
  }
  return hexArray;
};

var readFileAsArray = function(file, mode) {
  fileData = file;
  readFileAsArrayMode = mode;
  var promise = new Promise(getBuffer);
  promise
    .then(function(data) {
      var mode = readFileAsArrayMode;
      if (mode) {
        file1hex = data;
        document.getElementById("file1").value = writeHex(data, true);
      } else {
        file2hex = data;
        document.getElementById("file2").value = writeHex(data, true);
      }
    })
    .catch(function(err) {
      console.log("Error: ", err);
    });
};

var getBuffer = function(resolve) {
  var reader = new FileReader();
  reader.readAsArrayBuffer(fileData);
  reader.onload = function() {
    resolve(Convert(new Uint8Array(reader.result)));
  };
};
